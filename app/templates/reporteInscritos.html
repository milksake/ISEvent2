{%extends "layout.html"%}

{%block estilos%}
{%endblock%}

{%block title%}
E-vent
{%endblock%}

{%block contenido%}
{% if evento %}
    <h2>Reporte de Inscritos de {{ evento.nombre }}</h2>
    <br>
    <form action="" class="horizontal">
        <div>
        <label>Paquete</label>
        <select name="actividades">
            <option value="None">Todos</option>
            {% set actStrings = [] %}
            {% for paquete in evento.paquetes %}
                {{ actStrings.append(paquete.actividades|join(", ", attribute='nombre')) }}
            {% endfor %}
            {% for actS in actStrings | unique %}
                <option value="{{ actS }}">{{ actS }}</option>
            {% endfor %}
        </select>
        </div>
        <div>
        <label>Rol </label>
        <select name="rol">
            <option value="None">Todos</option>
            {% set roles = [] %}
            {% for paquete in evento.paquetes %}
                {{ roles.append(paquete.rol) }}
            {% endfor %}
            {% for rol in roles | unique %}
                <option value="{{ rol }}">{{ rol }}</option>
            {% endfor %}
        </select>
        </div>
        <div>
        <label>Fecha Inicio </label>
        <input type="datetime-local" name="fechaIni">
        </div>
        <div>
        <label>Fecha Fin </label>
        <input type="datetime-local" name="fechaFin">
        </div>
        <button class="btn" type="submit" style="margin-bottom: 0;">Aplicar Filtros</button>
    </form>
    <br>
    <table>
        <tr>
            <th>Cuenta</th>
            <th>Actividades</th>
            <th>Rol</th>
            <th>Fecha</th>
        </tr>
        {% for inscripcion in inscripciones %}     
            <tr>
                <td>{{ inscripcion.cuenta.nombre }}</td>
                <td>{{ inscripcion.paquete.actividades|join(', ', attribute='nombre') }}</td>
                <td>{{ inscripcion.paquete.rol }}</td>
                <td>{{ inscripcion.fecha }}</td>
            </tr>
        {% endfor %}
    </table>
    <br>
    <form action="" method="post">
        <button>Exportar</button>
    </form>
{% else %}
    <h2>Elige Evento</h2>
    <br>
    <ul>
    {% for eve in eventos %}
        <li><a href="{{ url_for('reporte.reporteInscritos', id=eve.id) }}">{{ eve.nombre }}</a></li>
    {% endfor %}
    </ul>
    
{% endif %}


{%endblock%}
